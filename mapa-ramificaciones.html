<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Ramificaciones - El Cazador de Medianoche</title>
    <link rel="stylesheet" href="styles.css">
    <script src="global-reset.js"></script>
    <style>
        .decision-tree {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #e0e0e0;
            padding: 30px;
            border-radius: 10px;
            overflow-x: auto;
            line-height: 1.6;
            margin: 20px 0;
        }
        
        .tree-level {
            margin-left: 0;
        }
        
        .tree-level-1 { margin-left: 20px; }
        .tree-level-2 { margin-left: 40px; }
        .tree-level-3 { margin-left: 60px; }
        .tree-level-4 { margin-left: 80px; }
        .tree-level-5 { margin-left: 100px; }
        
        .decision-node {
            color: #ffd700;
            font-weight: bold;
        }
        
        .branch-a {
            color: #87ceeb;
        }
        
        .branch-b {
            color: #98fb98;
        }
        
        .convergence {
            color: #dda0dd;
            font-weight: bold;
        }
        
        .final-node {
            color: #ff6b6b;
            font-weight: bold;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stats-card {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #ffd700;
        }
        
        .path-example {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #87ceeb;
        }
        
        .consequence-box {
            background: #3a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #98fb98;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .interactive-selector {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .decision-buttons {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .decision-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .decision-btn.option-a {
            background: #87ceeb;
            color: #1a1a1a;
        }
        
        .decision-btn.option-b {
            background: #98fb98;
            color: #1a1a1a;
        }
        
        .decision-btn:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }
        
        .path-result {
            margin-top: 20px;
            padding: 15px;
            background: #3a3a3a;
            border-radius: 8px;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <div class="navigation">
        <a href="index.html">← Índice</a>
        <a href="personajes.html">👥 Personajes</a>
        <a href="mundo-magico.html">🗺️ Mundo Mágico</a>
    </div>

    <h1>🗺️ Mapa Contextual de Ramificaciones</h1>
    <h2>El Cazador de Medianoche y las Lágrimas Robadas</h2>
    
    <div class="section-info">
        <p><strong>Sistema interactivo</strong> con 5 decisiones principales que generan 32 combinaciones únicas, convergiendo en 12 archivos HTML navegables con 2 finales distintos.</p>
    </div>

    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="background: #ffd700;"></div>
            <span>Decisiones</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #87ceeb;"></div>
            <span>Opción A</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #98fb98;"></div>
            <span>Opción B</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #dda0dd;"></div>
            <span>Convergencias</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ff6b6b;"></div>
            <span>Finales</span>
        </div>
    </div>

    <h2>🌳 Árbol Completo de Decisiones</h2>

    <div class="decision-tree">
<pre>
<span class="decision-node">📖 SECCION-01.HTML</span> (Inicio - Decisiones Secuenciales 1 & 2)
│
├─ <span class="decision-node">DECISIÓN 1: ¿Confiar en Seraphina?</span>
│  ├─ <span class="branch-a">A: Confianza Total</span> → Vínculo emocional fuerte, mayor manipulación
│  └─ <span class="branch-b">B: Cautela Vigilante</span> → Respeto intelectual, detección temprana
│
└─ <span class="decision-node">DECISIÓN 2: ¿Qué aliado buscar?</span>
   ├─ <span class="branch-a">A: Zorros Plateros</span> → Flechas anti-magia, herramientas físicas
   └─ <span class="branch-b">B: Murciélagos Bibliotecarios</span> → Flechas anti-engaño, conocimiento

<span class="decision-node">📄 RAMAS INICIALES</span> (Combinaciones D1+D2)
│
├─ <span class="branch-a">AA: seccion-01-aa.html</span> (Confianza + Zorros)
│  └─ ⏰ Auto-navega a convergencia-cuervos.html
│
├─ <span class="branch-a">AB: seccion-01-ab.html</span> (Confianza + Murciélagos)
│  └─ ⏰ Auto-navega a convergencia-cuervos.html
│
├─ <span class="branch-b">BA: seccion-01-ba.html</span> (Cautela + Zorros)
│  └─ ⏰ Auto-navega a convergencia-cuervos.html
│
└─ <span class="branch-b">BB: seccion-01-bb.html</span> (Cautela + Murciélagos)
   └─ ⏰ Auto-navega a convergencia-cuervos.html

<span class="convergence">🌲 CONVERGENCIA-CUERVOS.HTML</span> (Bosque de Cuervos Espejo)
│  └─ Revelación de Lyra, reacciones personalizadas según D1+D2
│
└─ <span class="decision-node">DECISIÓN 3: ¿Cómo proceder?</span>
   ├─ <span class="branch-a">A: Confrontación Directa</span> → Honestidad brutal, dinámicas tensas
   └─ <span class="branch-b">B: Espionaje e Infiltración</span> → Conocimiento completo de la red

<span class="decision-node">📄 ESTRATEGIAS</span>
│
├─ <span class="branch-a">seccion-02-a.html</span> (Confrontación)
│  └─ <span class="decision-node">DECISIÓN 4: ¿Qué preparación final?</span>
│     ├─ <span class="branch-a">A: Arañas Tejedoras</span> → Máximo conocimiento, vulnerabilidad emocional
│     └─ <span class="branch-b">B: Conejos Herbolarios</span> → Máxima claridad moral, menos preparación
│
└─ <span class="branch-b">seccion-02-b.html</span> (Espionaje)
   └─ <span class="decision-node">DECISIÓN 4: ¿Qué preparación final?</span>
      ├─ <span class="branch-a">A: Arañas Tejedoras</span> → Conocimiento + preparación completa
      └─ <span class="branch-b">B: Conejos Herbolarios</span> → Conocimiento + claridad moral

<span class="decision-node">📄 ALIADOS FINALES</span>
│
├─ <span class="branch-a">seccion-intermedia-a.html</span> (Arañas Tejedoras)
│  └─ ⏰ Auto-navega a convergencia-tejones.html
│
└─ <span class="branch-b">seccion-intermedia-b.html</span> (Conejos Herbolarios)
   └─ ⏰ Auto-navega a convergencia-tejones.html

<span class="convergence">⛏️ CONVERGENCIA-TEJONES.HTML</span> (Laberinto de Tejones)
│  └─ Visiones personalizadas según todas las decisiones previas
│
└─ <span class="decision-node">DECISIÓN 5: ¿Cómo usar las Lágrimas de Luna?</span>
   ├─ <span class="branch-a">A: Curación Directa</span> → Sanar a la madre inmediatamente
   └─ <span class="branch-b">B: Confrontación Final</span> → Forzar responsabilidad personal

<span class="final-node">🎭 FINALES</span>
│
├─ <span class="final-node">seccion-03-a.html</span> (Curación Inmediata)
│  └─ 🏥 Redención instantánea, santuario, trabajo continuo requerido
│
└─ <span class="final-node">seccion-03-b.html</span> (Crecimiento Gradual)
   └─ 🌱 Redención lenta pero sólida, centro de rehabilitación, cambio profundo
</pre>
    </div>

    <h2>📊 Estadísticas del Sistema</h2>

    <div class="stats-grid">
        <div class="stats-card">
            <h3>🔢 Combinaciones Totales</h3>
            <p><strong>32 rutas únicas posibles</strong></p>
            <p>5 decisiones binarias = 2⁵ = 32 combinaciones</p>
            <p>Todas convergen inteligentemente en 12 archivos HTML</p>
        </div>

        <div class="stats-card">
            <h3>📁 Archivos del Sistema</h3>
            <p><strong>12 archivos HTML navegables:</strong></p>
            <ul>
                <li>1 inicio con decisiones secuenciales</li>
                <li>4 ramas iniciales (auto-navegación)</li>
                <li>2 convergencias principales</li>
                <li>2 archivos de estrategia</li>
                <li>2 archivos de aliados (auto-navegación)</li>
                <li>2 finales completamente diferentes</li>
            </ul>
        </div>

        <div class="stats-card">
            <h3>⚙️ Características Técnicas</h3>
            <p><strong>Sistema JavaScript avanzado:</strong></p>
            <ul>
                <li>localStorage para persistencia</li>
                <li>Navegación automática inteligente</li>
                <li>Contenido dinámico personalizado</li>
                <li>Indicadores de progreso</li>
                <li>Sistema de reinicio completo</li>
            </ul>
        </div>

        <div class="stats-card">
            <h3>🎯 Impacto Narrativo</h3>
            <p><strong>Consecuencias reales:</strong></p>
            <ul>
                <li>Personalidades consistentes pero adaptables</li>
                <li>Herramientas diferentes según aliados</li>
                <li>Diálogos personalizados en convergencias</li>
                <li>Finales genuinamente diferentes</li>
                <li>Rejugabilidad alta</li>
            </ul>
        </div>
    </div>

    <h2>🛤️ Ejemplos de Rutas Específicas</h2>

    <div class="path-example">
        <h3>🔥 Ruta del Guerrero (A-A-A-A-A)</h3>
        <p><strong>Camino:</strong> Confianza Total → Zorros Plateros → Confrontación → Arañas → Curación Inmediata</p>
        <p><strong>Resultado:</strong> Axel forma vínculo emocional fuerte, obtiene armas poderosas, enfrenta directamente, obtiene conocimiento máximo pero paga con vulnerabilidad emocional, y elige el milagro instantáneo.</p>
        <p><strong>Final:</strong> Seraphina curada inmediatamente pero requiere apoyo constante. Santuario establecido.</p>
    </div>

    <div class="path-example">
        <h3>🕵️ Ruta del Estratega (B-B-B-A-B)</h3>
        <p><strong>Camino:</strong> Cautela → Murciélagos → Espionaje → Arañas → Confrontación Final</p>
        <p><strong>Resultado:</strong> Axel mantiene distancia, obtiene conocimiento anti-engaño, infiltra la red enemiga, obtiene preparación máxima, y fuerza crecimiento personal.</p>
        <p><strong>Final:</strong> Seraphina elige redención gradual. Centro de rehabilitación, cambio profundo y duradero.</p>
    </div>

    <div class="path-example">
        <h3>🕊️ Ruta del Sanador (A-B-A-B-A)</h3>
        <p><strong>Camino:</strong> Confianza → Murciélagos → Confrontación → Conejos → Curación Inmediata</p>
        <p><strong>Resultado:</strong> Axel confía pero obtiene herramientas de verdad, confronta directamente, elige aliados morales sobre tácticos, y opta por compasión inmediata.</p>
        <p><strong>Final:</strong> Equilibrio entre curación milagrosa y crecimiento moral sólido.</p>
    </div>

    <h2>🎮 Selector Interactivo de Rutas</h2>
    
    <div class="interactive-selector">
        <h3>🎯 Construye tu Propia Ruta</h3>
        <p>Selecciona opciones para cada decisión y ve el resultado:</p>
        
        <div>
            <strong>Decisión 1 - Confianza inicial:</strong>
            <div class="decision-buttons">
                <button class="decision-btn option-a" onclick="selectDecision(1, 'a')">A: Confianza Total</button>
                <button class="decision-btn option-b" onclick="selectDecision(1, 'b')">B: Cautela Vigilante</button>
            </div>
        </div>
        
        <div>
            <strong>Decisión 2 - Aliado inicial:</strong>
            <div class="decision-buttons">
                <button class="decision-btn option-a" onclick="selectDecision(2, 'a')">A: Zorros Plateros</button>
                <button class="decision-btn option-b" onclick="selectDecision(2, 'b')">B: Murciélagos Bibliotecarios</button>
            </div>
        </div>
        
        <div>
            <strong>Decisión 3 - Estrategia:</strong>
            <div class="decision-buttons">
                <button class="decision-btn option-a" onclick="selectDecision(3, 'a')">A: Confrontación</button>
                <button class="decision-btn option-b" onclick="selectDecision(3, 'b')">B: Espionaje</button>
            </div>
        </div>
        
        <div>
            <strong>Decisión 4 - Preparación final:</strong>
            <div class="decision-buttons">
                <button class="decision-btn option-a" onclick="selectDecision(4, 'a')">A: Arañas Tejedoras</button>
                <button class="decision-btn option-b" onclick="selectDecision(4, 'b')">B: Conejos Herbolarios</button>
            </div>
        </div>
        
        <div>
            <strong>Decisión 5 - Uso de Lágrimas:</strong>
            <div class="decision-buttons">
                <button class="decision-btn option-a" onclick="selectDecision(5, 'a')">A: Curación Directa</button>
                <button class="decision-btn option-b" onclick="selectDecision(5, 'b')">B: Confrontación Final</button>
            </div>
        </div>
        
        <div class="path-result" id="pathResult">
            <p>Selecciona opciones para ver el análisis de tu ruta...</p>
        </div>
    </div>

    <h2>🔄 Gestión de Historia</h2>

    <div class="quick-reset-section">
        <h3>🎮 Controles de Historia</h3>
        <p>¿Quieres comenzar una nueva aventura o ver tu progreso actual?</p>
        <div class="quick-reset-buttons">
            <button class="quick-reset-btn restart-from-beginning" onclick="quickResetStory()">
                🆕 Nueva Historia
            </button>
            <button class="quick-reset-btn" onclick="showCurrentProgress()">
                📊 Ver Mi Progreso
            </button>
            <button class="quick-reset-btn" onclick="if(confirm('¿Ir directamente a la primera decisión?')) window.location.href='seccion-01.html'">
                🚀 Ir a Decisiones
            </button>
        </div>
        <p style="font-size: 14px; margin-top: 15px; opacity: 0.8;">
            💡 <strong>Consejo:</strong> Puedes reiniciar tu historia en cualquier momento usando el botón flotante 🔄 que aparece en la esquina inferior derecha cuando tienes decisiones guardadas.
        </p>
    </div>

    <h2>🔄 Flujo de Navegación</h2>

    <div class="consequence-box">
        <h3>📋 Secuencia de Archivos</h3>
        <ol>
            <li><strong>seccion-01.html</strong> → Decisiones 1 & 2 → Una de 4 ramas</li>
            <li><strong>seccion-01-[rama].html</strong> → Auto-navegación (5s) → convergencia-cuervos.html</li>
            <li><strong>convergencia-cuervos.html</strong> → Decisión 3 → seccion-02-a.html o seccion-02-b.html</li>
            <li><strong>seccion-02-[estrategia].html</strong> → Decisión 4 → seccion-intermedia-a.html o seccion-intermedia-b.html</li>
            <li><strong>seccion-intermedia-[aliado].html</strong> → Auto-navegación (5s) → convergencia-tejones.html</li>
            <li><strong>convergencia-tejones.html</strong> → Decisión 5 → seccion-03-a.html o seccion-03-b.html</li>
            <li><strong>seccion-03-[final].html</strong> → Final de la historia</li>
        </ol>
    </div>

    <h2>🎨 Elementos Únicos por Ruta</h2>

    <div class="consequence-box">
        <h3>🔮 Contenido Personalizado</h3>
        <p><strong>Las convergencias cambian dinámicamente:</strong></p>
        <ul>
            <li><strong>convergencia-cuervos.html:</strong> Reacciones de Axel diferentes según Decisión 1 (confianza vs cautela)</li>
            <li><strong>convergencia-tejones.html:</strong> Visiones personalizadas que reflejan todas las decisiones previas</li>
            <li><strong>Ambos finales:</strong> Referencias específicas al camino tomado para llegar allí</li>
        </ul>
        
        <p><strong>Herramientas persistentes:</strong></p>
        <ul>
            <li><strong>Flechas de Zorros:</strong> Anti-magia, efectivas en combate directo</li>
            <li><strong>Flechas de Murciélagos:</strong> Anti-engaño, revelan verdades ocultas</li>
            <li><strong>Conocimiento de Arañas:</strong> Mapas completos, secretos compartidos</li>
            <li><strong>Bendiciones de Conejos:</strong> Hierbas curativas, claridad moral</li>
        </ul>
    </div>

    <div class="navigation">
        <a href="index.html">← Volver al Índice</a>
        <a href="personajes.html">👥 Personajes</a>
        <a href="mundo-magico.html">🗺️ Mundo Mágico</a>
    </div>

    <script>
        let currentPath = {};
        
        function selectDecision(decisionNum, choice) {
            console.log(`Seleccionando decisión ${decisionNum}, opción ${choice}`);
            
            currentPath[decisionNum] = choice;
            updatePathResult();
            
            // Reset all buttons for this decision
            const decisionButtons = document.querySelectorAll(`button[onclick*="selectDecision(${decisionNum},"]`);
            decisionButtons.forEach(btn => {
                btn.style.opacity = '0.5';
                btn.style.transform = 'scale(1)';
                btn.style.fontWeight = 'normal';
            });
            
            // Highlight selected button
            const selectedBtn = document.querySelector(`button[onclick="selectDecision(${decisionNum}, '${choice}')"]`);
            if (selectedBtn) {
                selectedBtn.style.opacity = '1';
                selectedBtn.style.transform = 'scale(1.05)';
                selectedBtn.style.fontWeight = 'bold';
            }
        }
        
        function updatePathResult() {
            const resultDiv = document.getElementById('pathResult');
            
            if (Object.keys(currentPath).length === 0) {
                resultDiv.innerHTML = '<p>Selecciona opciones para ver el análisis de tu ruta...</p>';
                return;
            }
            
            let html = '<h4>🛤️ Tu Ruta Seleccionada:</h4>';
            
            // Build path description
            let pathDesc = '';
            const descriptions = {
                1: { a: 'Confianza Total', b: 'Cautela Vigilante' },
                2: { a: 'Zorros Plateros', b: 'Murciélagos Bibliotecarios' },
                3: { a: 'Confrontación Directa', b: 'Espionaje e Infiltración' },
                4: { a: 'Arañas Tejedoras', b: 'Conejos Herbolarios' },
                5: { a: 'Curación Directa', b: 'Confrontación Final' }
            };
            
            for (let i = 1; i <= 5; i++) {
                if (currentPath[i]) {
                    if (pathDesc) pathDesc += ' → ';
                    pathDesc += descriptions[i][currentPath[i]];
                }
            }
            
            html += `<p><strong>${pathDesc}</strong></p>`;
            
            // Add consequences only for selected decisions
            if (Object.keys(currentPath).length > 0) {
                html += '<h5>📈 Consecuencias Acumuladas:</h5><ul>';
                
                if (currentPath[1] === 'a') html += '<li>💙 Vínculo emocional fuerte con Seraphina</li>';
                if (currentPath[1] === 'b') html += '<li>🧠 Respeto intelectual, detección temprana de engaños</li>';
                
                if (currentPath[2] === 'a') html += '<li>⚔️ Flechas anti-magia para combate directo</li>';
                if (currentPath[2] === 'b') html += '<li>👁️ Flechas anti-engaño para revelar verdades</li>';
                
                if (currentPath[3] === 'a') html += '<li>🗣️ Dinámicas directas y tensas con Seraphina</li>';
                if (currentPath[3] === 'b') html += '<li>🕵️ Conocimiento completo de la red genocida</li>';
                
                if (currentPath[4] === 'a') html += '<li>🕷️ Preparación máxima pero vulnerabilidad emocional</li>';
                if (currentPath[4] === 'b') html += '<li>🐰 Claridad moral máxima, menos preparación táctica</li>';
                
                if (currentPath[5] === 'a') html += '<li>✨ Redención inmediata de Seraphina, requiere apoyo continuo</li>';
                if (currentPath[5] === 'b') html += '<li>🌱 Redención gradual, cambio profundo y duradero</li>';
                
                html += '</ul>';
            }
            
            // Show final outcome if complete
            if (Object.keys(currentPath).length === 5) {
                html += '<h5>🎭 Resultado Final:</h5>';
                if (currentPath[5] === 'a') {
                    html += '<p><strong>Final A:</strong> Santuario de Reconciliación establecido. Seraphina curada instantáneamente por el amor hacia su madre, pero necesita apoyo emocional continuo. Los jóvenes de diferentes especies aprenden a convivir pacíficamente.</p>';
                } else {
                    html += '<p><strong>Final B:</strong> Centro de Rehabilitación establecido. Seraphina elige la redención personal a través del trabajo diario y la responsabilidad. Su transformación gradual pero sólida inspira a futuras generaciones.</p>';
                }
                
                // Show file navigation path
                html += '<h5>📁 Archivos que Navegarías:</h5>';
                const branch = currentPath[1] + currentPath[2];
                html += '<p><code>seccion-01.html → ';
                html += `seccion-01-${branch}.html → convergencia-cuervos.html → `;
                html += `seccion-02-${currentPath[3]}.html → seccion-intermedia-${currentPath[4]}.html → `;
                html += `convergencia-tejones.html → seccion-03-${currentPath[5]}.html</code></p>`;
            }
            
            resultDiv.innerHTML = html;
        }

        // Functions for the management section
        function quickResetStory() {
            if (confirm('¿Estás seguro de que quieres reiniciar completamente tu historia? Esto borrará todas las decisiones guardadas.')) {
                localStorage.clear();
                currentPath = {};
                updatePathResult();
                
                // Reset all button states
                document.querySelectorAll('.decision-btn').forEach(btn => {
                    btn.style.opacity = '1';
                    btn.style.transform = 'scale(1)';
                    btn.style.fontWeight = 'normal';
                });
                
                alert('Historia reiniciada. ¡Puedes comenzar una nueva aventura!');
            }
        }

        function showCurrentProgress() {
            const saved = localStorage.getItem('storyDecisions');
            let message = '📊 Tu Progreso Actual:\n\n';
            
            if (saved) {
                const decisions = JSON.parse(saved);
                message += 'Decisiones guardadas en tu navegador:\n';
                for (let key in decisions) {
                    message += `• Decisión ${key}: ${decisions[key]}\n`;
                }
            } else {
                message += 'No hay decisiones guardadas actualmente.\nPuedes comenzar una nueva historia.';
            }
            
            alert(message);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updatePathResult();
        });
    </script>
</body>
</html>